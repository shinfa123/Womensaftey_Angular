<div class="edit-user-page">
  <header class="topbar">
    <div class="brand">
      <span class="logo">✏️</span>
      <span class="name">Edit User</span>
    </div>
    <nav class="actions">
      <a routerLink="/user-management" class="link">Back to User Management</a>
    </nav>
  </header>

  <main class="content">
    <section class="form-section">
      <div class="form-header">
        <h1>Edit User</h1>
        <p>Update user information</p>
      </div>

      <div class="error-message" *ngIf="error">
        {{ error }}
      </div>

      <div class="success-message" *ngIf="success">
        {{ success }}
      </div>

      <form [formGroup]="form" (ngSubmit)="submit()" novalidate>
        <div class="form-grid">
          <div class="field" [class.invalid]="form.controls['name'].touched && form.controls['name'].invalid">
            <label for="name">Name</label>
            <input id="name" type="text" formControlName="name" placeholder="Enter full name" />
            <small class="hint" *ngIf="form.controls['name'].touched && form.controls['name'].hasError('required')">
              Name is required
            </small>
          </div>

          <div class="field" [class.invalid]="form.controls['age'].touched && form.controls['age'].invalid">
            <label for="age">Age</label>
            <input id="age" type="number" formControlName="age" placeholder="Enter age" />
            <small class="hint" *ngIf="form.controls['age'].touched && form.controls['age'].hasError('required')">
              Age is required
            </small>
            <small class="hint" *ngIf="form.controls['age'].touched && form.controls['age'].hasError('min')">
              Age must be at least 1
            </small>
            <small class="hint" *ngIf="form.controls['age'].touched && form.controls['age'].hasError('max')">
              Age must be at most 120
            </small>
          </div>

                     <div class="field" [class.invalid]="form.controls['place'].touched && form.controls['place'].invalid">
             <label for="place">Place</label>
             <input id="place" type="text" formControlName="place" placeholder="Enter place" />
             <small class="hint" *ngIf="form.controls['place'].touched && form.controls['place'].hasError('required')">
               Place is required
             </small>
           </div>

           <div class="field" [class.invalid]="form.controls['department'].touched && form.controls['department'].invalid">
             <label for="department">Department</label>
             <select id="department" formControlName="department">
               <option value="">Select department</option>
               <option value="1">Computer Science</option>
               <option value="2">Electrical Engineering</option>
               <option value="3">Mechanical Engineering</option>
               <option value="4">Civil Engineering</option>
               <option value="5">Information Technology</option>
             </select>
             <small class="hint" *ngIf="form.controls['department'].touched && form.controls['department'].hasError('required')">
               Department is required
             </small>
           </div>

          <div class="field" [class.invalid]="form.controls['phoneno'].touched && form.controls['phoneno'].invalid">
            <label for="phoneno">Phone Number</label>
            <input id="phoneno" type="tel" formControlName="phoneno" placeholder="Enter phone number" />
            <small class="hint" *ngIf="form.controls['phoneno'].touched && form.controls['phoneno'].hasError('required')">
              Phone number is required
            </small>
          </div>

          <div class="field" [class.invalid]="form.controls['email'].touched && form.controls['email'].invalid">
            <label for="email">Email</label>
            <input id="email" type="email" formControlName="email" placeholder="Enter email address" />
            <small class="hint" *ngIf="form.controls['email'].touched && form.controls['email'].hasError('required')">
              Email is required
            </small>
            <small class="hint" *ngIf="form.controls['email'].touched && form.controls['email'].hasError('email')">
              Please enter a valid email address
            </small>
          </div>

          <div class="field" [class.invalid]="form.controls['userName'].touched && form.controls['userName'].invalid">
            <label for="userName">Username</label>
            <input id="userName" type="text" formControlName="userName" placeholder="Enter username" />
            <small class="hint" *ngIf="form.controls['userName'].touched && form.controls['userName'].hasError('required')">
              Username is required
            </small>
          </div>

                     <div class="field" [class.invalid]="form.controls['password'].touched && form.controls['password'].invalid">
             <label for="password">Password</label>
             <div class="password-input">
               <input 
                 id="password" 
                 [type]="showPassword ? 'text' : 'password'" 
                 formControlName="password" 
                 placeholder="Enter password" 
               />
               <button 
                 type="button" 
                 class="password-toggle" 
                 (click)="togglePassword()"
                 [attr.aria-label]="showPassword ? 'Hide password' : 'Show password'"
               >
                 {{ showPassword ? '👁️' : '👁️‍🗨️' }}
               </button>
             </div>
             <small class="hint" *ngIf="form.controls['password'].touched && form.controls['password'].hasError('required')">
               Password is required
             </small>
             <small class="hint" *ngIf="form.controls['password'].touched && form.controls['password'].hasError('minlength')">
               Password must be at least 6 characters
             </small>
           </div>

                     <div class="field" [class.invalid]="form.controls['semester'].touched && form.controls['semester'].invalid">
             <label for="semester">Semester</label>
             <select id="semester" formControlName="semester">
               <option value="">Select semester</option>
               <option value="1">Semester 1</option>
               <option value="2">Semester 2</option>
               <option value="3">Semester 3</option>
               <option value="4">Semester 4</option>
               <option value="5">Semester 5</option>
               <option value="6">Semester 6</option>
               <option value="7">Semester 7</option>
               <option value="8">Semester 8</option>
             </select>
             <small class="hint" *ngIf="form.controls['semester'].touched && form.controls['semester'].hasError('required')">
               Semester is required
             </small>
           </div>

           <div class="field" [class.invalid]="form.controls['batch'].touched && form.controls['batch'].invalid">
             <label for="batch">Batch Year</label>
             <input id="batch" type="number" formControlName="batch" placeholder="Enter batch year (e.g., 2022)" />
             <small class="hint" *ngIf="form.controls['batch'].touched && form.controls['batch'].hasError('required')">
               Batch year is required
             </small>
             <small class="hint" *ngIf="form.controls['batch'].touched && form.controls['batch'].hasError('min')">
               Batch year must be at least 2000
             </small>
             <small class="hint" *ngIf="form.controls['batch'].touched && form.controls['batch'].hasError('max')">
               Batch year must be at most 2030
             </small>
           </div>

                     <div class="field checkbox-field">
             <label class="checkbox-label">
               <input type="checkbox" formControlName="isActive" />
               <span class="checkmark"></span>
               Activate User
             </label>
           </div>
        </div>

                 <div class="form-actions">
           <button type="button" class="btn btn-secondary" (click)="goBack()">
             Cancel
           </button>
           <button class="btn btn-primary" type="submit" [disabled]="isSubmitting || !form.valid">
             {{ isSubmitting ? 'Updating...' : 'Update User' }}
           </button>
        </div>
      </form>
    </section>
  </main>
</div>
